\input{prelude}

\SetupMinted{}
\SetupBibliography{relazione.bib}

\begin{document}

\twocolumn[{\begin{figure}[H]
        \setlength{\linewidth}{\textwidth}
        \setlength{\hsize}{\textwidth}
        \centering
        \begin{NiceTabular}{rl}
            \Block{3-1}{\includegraphics[height=20ex]{logo}} & {\Large\bfseries Carroponte smart}                                        \\
                                                             & Giuseppe Damiata, Vincenzo Mazza, Nicolò Spingola \\
                                                             & Università degli studi di Palermo, Dipartimento di Ingegneria, Hangar\_9
                                                             \\ \\ \\ % extra rows for logo spacing
        \end{NiceTabular}
\end{figure}}]

\begin{abstract}
    Nella presente relazione si descrive il progetto di un sistema di controllo per un carroponte
    completamente automatizzato mediante l'utilizzo sinergico di un PLC Zelio Logic SR3B261BD ed
    un Arduino MEGA. Esso è capace di caricare e scaricare container da una nave merce, con
    l'ausilio di due zone di carico poste sulla nave e due zone di carico poste sul porto. Il
    sistema presenta inoltre la possibilità di essere telecontrollato remotamente mediante il
    protocollo Modbus, grazie al sistema SCADA.
    \cite{arm2015real}
\end{abstract}

\section{Introduzione e scopo del progetto}

I carriponte sono macchine utilizzate per il sollevamento e lo spostamento di carichi pesanti.
Trovano larga applicazione in innumerevoli campi, tra cui le navi merce, cantieri edili e magazzini,
pertanto sono un ottimo esempio di possibilità applicativa dell'automazione industriale.
\cite{ren2021design,li2015data}

La loro automatizzazione permette di ridurre di gran lunga i tempi di fermo macchina, ed inoltre
aumenta notevolmente la sicurezza in quanto toglie dall'equazione gli errori umani.
\cite{gupta2004simplified}

Nella trattazione successiva andremmo a delineare il nostro prototipo di sistema di
controllo per un carroponte portuale, basato sull'utilizzo di un PLC Zelio Logic SR3B261BD per
l'automatizzazione progressiva di un sistema precedentemente ad-hoc. Il basso costo del sopracitato
dispositivo permette ad un impianto già esistente di mantenere le sue funzioni di base, mentre il
PLC svolge le sue mansioni di telecontrollo e monitoraggio.

% Le dimensioni complessive sono $\qty{25}{\cm} \times \qty{16}{\cm} \times \qty{24}{\cm}$.

\section{Design e componenti}

Il modello per la stampa 3D è stato realizzato mediante il software \emph{AutoDesk Fusion 360} e
stampato su una coppia di stampanti, rispettivamente una \emph{Eryone Thinker SE} ed una
\emph{Wunhao GR2}. Il modello è stato realizzato in modo da poter essere stampato in più parti, date
le limitazioni di dimensione dei piatti di stampa, e poi assemblato mediante una vasta gamma di
accoppiamenti, tra cui incastri, colla e viti.

Sia sulla nave che sul porto sono state realizzate apposite tasche per alloggiare i container,
all'interno delle quali sono state inserite delle fotoresistenze per la rilevazione della presenza o
assenza di quest'ultimi.

Il porto presenta poi delle guide all'interno delle quali scorre il carroponte, mediante un
servomotore, su un asse detta X. Sul carroponte vi sono due cremagliere, veicolate anch'esse da due
motori servo, rispettivamente denominate Y per l'asse propria del carroponte e Z per l'asse di
sollevamento.

L'asse Z presenta sulla sua estremità inferiore un elettromagnete controllabile mediante corrente
continua responsabile per l'aggancio e lo sgancio dei container, i quali sono dotati di un'apposita
parte magnetica per il sollevamento.

\section{Sistema di controllo}

Il sistema di controllo è, come anticipato, di duplice natura: Esso consiste in un PLC Zelio Logic
SR3B261BD ed un Arduino MEGA. Il primo implementa la logica di telecontrollo e
telemonitoraggio, comunicando con lo SCADA mediante il protocollo Modbus; il secondo implementa il
controllo locale dei servomotori e dei fotoresistori.

L'algoritmo di controllo automatico controlla ciclicamente la presenza di container da spostare, ed
al momento della rilevazione effettua lo spostamento senza intervento umano. Le zone sono
dinamicamente trattate come zone di carico e di scarico, cioè il carroponte è capace di rilevare
carichi posti nelle zone da operatori (che sono quindi da spostare) e carichi posti dal carroponte
stesso (che sono quindi in attesa di un operatore che li rimuova).

Particolare attenzione è stata prestata alla comunicazione tra PLC ed Arduino. I pin di
comunicazione dal PLC ad Arduino utilizzano i resistori interni pull-up di quest'ultimo, cioè ai
relè d'uscita del PLC vi è collegata la massa comune tra i due dispositivi, onde evitare problemi
per i livelli di tensione discordanti tra i due dispositivi. I pin di comunicazione da Arduino al
PLC sono perlopiù analogici, ed utilizzano un filtro passa-basso del primo ordine per rendere gli
impulsi PWM del microcontrollore un segnale analogico di tensione, estraendo da essi il livello di
continua.

Inoltre le letture dei fotoresistori utilizzano una media nel tempo (cioè formalmente un filtro
passa-basso) per evitare false rilevazioni. La loro taratura è effettuata automaticamente all'avvio
del programma, ed il microcontrollore Arduino comunica al PLC lo stato dei fotoresistori in basa
alla taratura da esso effettuata.

\section{Sistema SCADA}

Il sistema SCADA è stato realizzato con il software Vijeo Citect. Esso comunica in tempo reale con
il PLC (e quindi con Arduino) mediante il protocollo Modbus, e permette di monitorare lo stato del
sistema e di controllarlo manualmente. In particolare è possibile controllare manualmente le
posizioni di tutte e tre le assi, attivare/disattivare il magnete e ottenere le letture di tutte le
zone di carico/scarico.

\begin{figure}[htbp]\centering
    \caption{Il sistema SCADA in funzione.}
    \includegraphics[width=\linewidth]{scada.png}
\end{figure}

\begin{figure}[htbp]\centering
    \caption{Il modello 3D del carroponte.}
    \includegraphics[width=\linewidth]{render-carroponte.png}
\end{figure}

\printbibliography

\tcbinputlisting{title={Lo sketch principale.}, minted language=cpp, listing file=../ProgrammaPrincipale/ProgrammaPrincipale.ino}

\tcbinputlisting{title={Header per il controllo degli assi con servo.}, minted language=cpp, listing file=../ProgrammaPrincipale/ServoAxis.hpp}
\tcbinputlisting{title={File principale per il controllo degli assi con servo.}, minted language=cpp, listing file=../ProgrammaPrincipale/ServoAxis.cpp}

\tcbinputlisting{title={Header per la gestione delle zone.}, minted language=cpp, listing file=../ProgrammaPrincipale/Zone.hpp}
\tcbinputlisting{title={File principale per la gestione delle zone.}, minted language=cpp, listing file=../ProgrammaPrincipale/Zone.cpp}

\begin{figure*}[htbp]\centering
    \caption{Lo schema elettrico del sistema.}
    \includegraphics[width=\linewidth]{SchemaKiCAD}
\end{figure*}

\begin{figure*}[htbp]\centering
    \caption{Il programma caricato nel PLC.}
    \includegraphics[width=\linewidth]{programma-zelio}
\end{figure*}

\end{document}
% vim: ft=tex
